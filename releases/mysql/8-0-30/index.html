<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Changes in MySQL 8.0.30 | Tom's Notebook</title><meta name=description content="Character Set Support Important Change: A previous change renamed character sets having deprecated names prefixed with utf8_ to use utf8mb3_ instead. In this release, we rename the utf8_ collations as well, using the utf8mb3_ prefix; this is to make the collation names consistent with those of the character sets, not to rely any longer on the deprecated collation names, and to clarify the distinction between utf8mb3 and utf8mb4. The names using the utf8mb3_ prefix are now used exclusively for these collations in the output of SHOW statements such as SHOW CREATE TABLE, as well as in the values displayed in the columns of Information Schema tables including the COLLATIONS and COLUMNS tables."><meta property="og:title" content="Changes in MySQL 8.0.30"><meta property="og:description" content="Character Set Support Important Change: A previous change renamed character sets having deprecated names prefixed with utf8_ to use utf8mb3_ instead. In this release, we rename the utf8_ collations as well, using the utf8mb3_ prefix; this is to make the collation names consistent with those of the character sets, not to rely any longer on the deprecated collation names, and to clarify the distinction between utf8mb3 and utf8mb4. The names using the utf8mb3_ prefix are now used exclusively for these collations in the output of SHOW statements such as SHOW CREATE TABLE, as well as in the values displayed in the columns of Information Schema tables including the COLLATIONS and COLUMNS tables."><meta property="og:type" content="article"><meta property="og:url" content="/releases/mysql/8-0-30/"><meta property="article:section" content="releases"><meta property="article:published_time" content="2022-07-26T14:46:59+00:00"><meta property="article:modified_time" content="2022-07-26T14:46:59+00:00"><meta itemprop=name content="Changes in MySQL 8.0.30"><meta itemprop=description content="Character Set Support Important Change: A previous change renamed character sets having deprecated names prefixed with utf8_ to use utf8mb3_ instead. In this release, we rename the utf8_ collations as well, using the utf8mb3_ prefix; this is to make the collation names consistent with those of the character sets, not to rely any longer on the deprecated collation names, and to clarify the distinction between utf8mb3 and utf8mb4. The names using the utf8mb3_ prefix are now used exclusively for these collations in the output of SHOW statements such as SHOW CREATE TABLE, as well as in the values displayed in the columns of Information Schema tables including the COLLATIONS and COLUMNS tables."><meta itemprop=datePublished content="2022-07-26T14:46:59+00:00"><meta itemprop=dateModified content="2022-07-26T14:46:59+00:00"><meta itemprop=wordCount content="7297"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Changes in MySQL 8.0.30"><meta name=twitter:description content="Character Set Support Important Change: A previous change renamed character sets having deprecated names prefixed with utf8_ to use utf8mb3_ instead. In this release, we rename the utf8_ collations as well, using the utf8mb3_ prefix; this is to make the collation names consistent with those of the character sets, not to rely any longer on the deprecated collation names, and to clarify the distinction between utf8mb3 and utf8mb4. The names using the utf8mb3_ prefix are now used exclusively for these collations in the output of SHOW statements such as SHOW CREATE TABLE, as well as in the values displayed in the columns of Information Schema tables including the COLLATIONS and COLUMNS tables."><link rel=preload href=/scss/main.min.d53a00c4ba41d1d027bb4ee988a4a0470b4c0e7c7560146141687f31049f161f.css as=style><link href=/scss/main.min.d53a00c4ba41d1d027bb4ee988a4a0470b4c0e7c7560146141687f31049f161f.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<script>console.log("updated at 2023-03-12 16:45:14")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-3TEJLB7B10"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3TEJLB7B10",{anonymize_ip:!1})}</script></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class=font-weight-bold>Tom's Notebook</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/editor/><span>Editor</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/releases/><span class=active>Release News</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.0b9d3a2a0a2d2b937ee6d0263896fd47.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.0b9d3a2a0a2d2b937ee6d0263896fd47.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-releases-li><a href=/releases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-releases><span>Release News</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-releasesmysql-li><a href=/releases/mysql/ title="MySQL Release Notes" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-releasesmysql><span>MySQL</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-releasesmysql8-0-30-li><a href=/releases/mysql/8-0-30/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-releasesmysql8-0-30><span class=td-sidebar-nav-active-item>Changes in MySQL 8.0.30</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-releasesredis-li><a href=/releases/redis/ title="Redis Release Notes" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-releasesredis><span>Redis</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-releasesredis7-0-4-li><a href=/releases/redis/7-0-4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-releasesredis7-0-4><span>Redis 7.0.4 Release Notes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-releasesredis7-0-3-li><a href=/releases/redis/7-0-3/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-releasesredis7-0-3><span>Redis 7.0.3 Release Notes</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-releasesgolang-li><a href=/releases/golang/ title="Go Release Notes" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-releasesgolang><span>Go</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-releasesgolang1-18-li><a href=/releases/golang/1-18/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-releasesgolang1-18><span>Go 1.18 Release Notes</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><ul><li><a href=#character-set-support>Character Set Support</a></li><li><a href=#compilation-notes>Compilation Notes</a></li><li><a href=#deprecation-and-removal-notes>Deprecation and Removal Notes</a></li><li><a href=#generated-invisible-primary-keys-gipks>Generated Invisible Primary Keys (GIPKs)</a></li><li><a href=#keyring-notes>Keyring Notes</a></li><li><a href=#pluggable-authentication>Pluggable Authentication</a></li><li><a href=#security-notes>Security Notes</a></li><li><a href=#spatial-data-support>Spatial Data Support</a></li><li><a href=#sql-syntax-notes>SQL Syntax Notes</a></li><li><a href=#xa-transaction-notes>XA Transaction Notes</a></li><li><a href=#functionality-added-or-changed>Functionality Added or Changed</a></li><li><a href=#bugs-fixed>Bugs Fixed</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><a class="btn btn-lg -bg-orange td-rss-button d-none d-lg-block" href=/releases/mysql/index.xml target=_blank>RSS <i class="fa fa-rss ml-2"></i></a><div class=td-content><h1>Changes in MySQL 8.0.30</h1><div class="td-byline mb-4"><time datetime=2022-07-26 class=text-muted>Tuesday, July 26, 2022</time></div><header class=article-meta></header><h3 id=character-set-support>Character Set Support</h3><ul><li><p><strong>Important Change:</strong> A previous change renamed character sets having deprecated names prefixed with <code>utf8_</code> to use <code>utf8mb3_</code> instead. In this release, we rename the <code>utf8_</code> collations as well, using the <code>utf8mb3_</code> prefix; this is to make the collation names consistent with those of the character sets, not to rely any longer on the deprecated collation names, and to clarify the distinction between <code>utf8mb3</code> and <code>utf8mb4</code>. The names using the <code>utf8mb3_</code> prefix are now used exclusively for these collations in the output of <code>SHOW</code> statements such as <a href=https://dev.mysql.com/doc/refman/8.0/en/show-create-table.html><code>SHOW CREATE TABLE</code></a>, as well as in the values displayed in the columns of Information Schema tables including the <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-collations-table.html><code>COLLATIONS</code></a> and <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html><code>COLUMNS</code></a> tables. (Bug #33787300)</p><p>References: See also: Bug #30624990.</p></li><li><p><strong>Important Change:</strong> When more than one language had the same collation definition, MySQL implemented collations for only one of the languages. This meant that some languages were covered only by <code>utf8mb4</code> Unicode 9.0 collations that are specific to other languages. This release fixes such issues by adding language-specific collations for those languages that were previously covered only by language-specific collations for other languages. The new collations are listed here:</p><ul><li><p><em>Norwegian</em></p><ul><li><p>(Bokmål) <code>utf8mb4_nb_0900_ai_ci</code></p></li><li><p>(Bokmål) <code>utf8mb4_nb_0900_as_cs</code></p></li><li><p>(Nynorsk) <code>utf8mb4_nn_0900_ai_ci</code></p></li><li><p>(Nynorsk) <code>utf8mb4_nn_0900_as_cs</code></p></li></ul></li><li><p><em>Serbian with Latin characters</em>:</p><ul><li><p><code>utf8mb4_sr_latn_0900_ai_ci</code></p></li><li><p><code>utf8mb4_sr_latn_0900_as_cs</code></p></li></ul></li><li><p><em>Bosnian with Latin characters</em>:</p><ul><li><p><code>utf8mb4_bs_0900_ai_ci</code></p></li><li><p><code>utf8mb4_bs_0900_as_cs</code></p></li></ul></li><li><p><em>Bulgarian</em>:</p><ul><li><p><code>utf8mb4_bg_0900_ai_ci</code></p></li><li><p><code>utf8mb4_bg_0900_as_cs</code></p></li></ul></li><li><p><em>Galician</em>:</p><ul><li><p><code>utf8mb4_gl_0900_ai_ci</code></p></li><li><p><code>utf8mb4_gl_0900_as_cs</code></p></li></ul></li><li><p><em>Mongolian with Cyrillic letters</em>:</p><ul><li><p><code>utf8mb4_mn_cyrl_0900_ai_ci</code></p></li><li><p><code>utf8mb4_mn_cyrl_0900_as_cs</code></p></li></ul></li></ul><p>For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/charset-unicode-sets.html#charset-unicode-sets-language-specific-collations>Language-Specific Collations</a>. (Bug #31885256)</p></li></ul><h3 id=compilation-notes>Compilation Notes</h3><ul><li><p>On Enterprise Linux, fixed ADD_LINUX_RPM_FLAGS so that the initial values of CMAKE_C_FLAGS and CMAKE_CXX_FLAGS are used before modifying them. (Bug #34131794)</p><p>References: This issue is a regression of: Bug #33730302.</p></li><li><p>Added a new SHOW_SUPPRESSED_COMPILER_WARNINGS CMake option. Enable it to show suppressed compiler warnings, and do so without failing with -Werror. It defaults to OFF. (Bug #34046748)</p></li><li><p>On Windows, deprecation warnings (C4996) were globally disabled with the /wd4996 command-line option; now deprecation warnings are disabled on the localized level where appropriate. (Bug #33975638)</p></li><li><p>Improved GCC 8 support to include -lstdc++fs in order to use std::filesystem. (Bug #33939798)</p></li></ul><h3 id=deprecation-and-removal-notes>Deprecation and Removal Notes</h3><ul><li><p><strong>Replication:</strong> Setting the <a href=https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_replica_parallel_workers><code>replica_parallel_workers</code></a> system variable (or the equivalent server option <code>--replica-parallel-workers</code>) to 0 is now deprecated, and doing so now raises a warning.</p><p>To achieve the same result (that is, use single threading) without the warning, set <code>replica_parallel_workers=1</code> instead.</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_skip-host-cache><code>--skip-host-cache</code></a> server option is now deprecated, and subject to removal in a future release.</p><p>Use a statement such as <a href=https://dev.mysql.com/doc/refman/8.0/en/set-variable.html><code>SET GLOBAL host_cache_size = 0</code></a>, or set <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_host_cache_size><code>host_cache_size</code></a> in the <code>my.cnf</code> file, instead.</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_old-style-user-limits><code>--old-style-user-limits</code></a> option causes the server to enforce user limits as they were prior to MySQL 5.0.3, and is intended for backwards compatibility with very old releases. This option is now deprecated, and using it now raises a warning. You should expect this option to be removed in a future release of MySQL, and so you are advised to begin now to remove any dependency your MySQL applications might have on this option.</p></li></ul><h3 id=generated-invisible-primary-keys-gipks>Generated Invisible Primary Keys (GIPKs)</h3><ul><li><p>MySQL 8.0.30 now supports GIPK mode, which causes a generated invisible primary key (GIPK) to be added to any <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html><code>InnoDB</code></a> table that is created without an explicit primary key. This enhancement applies to <code>InnoDB</code> tables only.</p><p>The definition of the generated key column added to an <code>InnoDB</code> table by GIPK mode is is shown here:</p><p>Press ⌘+C to copy</p><p><code>my_row_id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT INVISIBLE PRIMARY KEY</code></p><p>The name of the generated primary key is always <code>my_row_id</code>; you cannot, while GIPK mode is in effect, use this as a column name in a <a href=https://dev.mysql.com/doc/refman/8.0/en/create-table.html><code>CREATE TABLE</code></a> statement that creates a new <code>InnoDB</code> table unless it includes an explicit primary key.</p><p>GIPKs are not enabled by default. To enable them, set the <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_sql_generate_invisible_primary_key><code>sql_generate_invisible_primary_key</code></a> server system variable (also introduced in this release) to <code>ON</code>. This setting has no effect on replication applier threads; this means that a replica never generates a primary key for a replicated table that was not created on the source with a primary key.</p><p>You cannot alter a generated invisible primary key while GIPKs are in effect, with one exception: You can toggle the visibility of the GIPK using <code>ALTER TABLE *`tbl`* CHANGE COLUMN my_row_id SET VISIBLE</code> and <code>ALTER TABLE *`tbl`* CHANGE COLUMN my_row_id SET INVISIBLE</code>.</p><p>By default, generated invisible primary keys can be seen in the output of <a href=https://dev.mysql.com/doc/refman/8.0/en/show-create-table.html><code>SHOW CREATE TABLE</code></a> and <a href=https://dev.mysql.com/doc/refman/8.0/en/show-index.html><code>SHOW INDEX</code></a>; they are also visible in MySQL Information Schema tables such as the <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html><code>COLUMNS</code></a> and <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-statistics-table.html><code>STATISTICS</code></a> tables. You can make them hidden instead by setting <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_show_gipk_in_create_table_and_information_schema><code>show_gipk_in_create_table_and_information_schema</code></a> to <code>OFF</code>.</p><p>You can exclude generated invisible primary keys from the output of <strong>mysqldump</strong> using the <a href=https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_skip-generated-invisible-primary-key><code>--skip-generated-invisible-primary-key</code></a> option added in this release. <strong>mysqlpump</strong> also now supports a <a href=https://dev.mysql.com/doc/refman/8.0/en/mysqlpump.html#option_mysqlpump_skip-generated-invisible-primary-key><code>--skip-generated-invisible-primary-key</code></a> option which excludes GIPKs from its output.</p><p>For more information and examples, see <a href=https://dev.mysql.com/doc/refman/8.0/en/create-table-gipks.html>Generated Invisible Primary Keys</a>. For general information on invisible column support in MySQL, see <a href=https://dev.mysql.com/doc/refman/8.0/en/invisible-columns.html>Invisible Columns</a>. (Bug #34092605)</p></li></ul><h3 id=keyring-notes>Keyring Notes</h3><ul><li><p>The <code>keyring_aws</code> plugin has been updated to use the latest AWS Encryption SDK for C (version 1.9.186).</p><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/keyring-system-variables.html#sysvar_keyring_aws_region><code>keyring_aws_region</code></a> variable supports the additional AWS regions supported by the new SDK. Refer to the variable description for a list of supported AWS regions.</p></li></ul><h3 id=pluggable-authentication>Pluggable Authentication</h3><ul><li>The SASL LDAP plugin failed to properly parse Kerberos Key Distribution Center (KDC) host information read from the Kerberos configuration file, resulting in SASL authentication error. (Bug #31862170)</li></ul><h3 id=security-notes>Security Notes</h3><ul><li>It is now possible to compile the MySQL server package (<strong>mysqld</strong> + <code>libmysql</code> + client tools) using OpenSSL 3.0 on supported platforms, which should not change the behavior of the server or client programs. For additional information, see <a href=https://wiki.openssl.org/index.php/OpenSSL_3.0>https://wiki.openssl.org/index.php/OpenSSL_3.0</a>.</li></ul><h3 id=spatial-data-support>Spatial Data Support</h3><ul><li>Previously, the <a href=https://dev.mysql.com/doc/refman/8.0/en/spatial-operator-functions.html#function_st-transform><code>ST_TRANSFORM()</code></a> function added in MySQL 8.0.13 did not support Cartesian Spatial Reference Systems. Beginning with this release, support is provided by this function for the Popular Visualisation Pseudo Mercator (EPSG 1024) projection method, used for WGS 84 Pseudo-Mercator (SRID 3857).</li></ul><h3 id=sql-syntax-notes>SQL Syntax Notes</h3><ul><li><p>It is now possible to determine whether a <a href=https://dev.mysql.com/doc/refman/8.0/en/revoke.html><code>REVOKE</code></a> statement which cannot be executed raises an error or a warning. This is implemented with the addition of two new statement options, listed here with brief descriptions:</p><ul><li><p><code>IF EXISTS</code> causes <code>REVOKE</code> to raise a warning rather than an error as long as the target user or role does not exist.</p></li><li><p><code>IGNORE UNKNOWN USER</code> causes <code>REVOKE</code> to raise a warning instead of an error if the target user or role is not known, but the statement would otherwise succeed.</p></li></ul><p>For a single target user or role and a given privilege or role to be removed, using the <code>IF EXISTS</code> and <code>IGNORE UNKNOWN USER</code> options together in the same <code>REVOKE</code> statement means that the statement succeeds (albeit doing nothing, and with a warning), even if both the target user or role and the privilege or role to be removed are unknown, as long as the statement is otherwise valid. In the case of multiple targets, multiple privileges or roles to be removed, or both, the statement succeeds, performing those removals which are valid, and issuing warnings for those which are not.</p><p>For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/revoke.html>REVOKE Statement</a>. (Bug #102232, Bug #32495441)</p></li></ul><h3 id=xa-transaction-notes>XA Transaction Notes</h3><ul><li><p><strong>Replication:</strong> Previously, recovery was not guaranteed when a server node in a replication topology unexpectedly halted while executing <a href=https://dev.mysql.com/doc/refman/8.0/en/xa-statements.html><code>XA PREPARE</code></a>, <code>XA COMMIT</code>, or <code>XA ROLLBACK</code>. To address this problem, MySQL now maintains consistent XA transaction state across a topology using either MySQL “classic” Replication or MySQL Group Replication when a server node is lost from the topology and then regained. This also means that XA transaction state is now propagated so that nodes do not diverge while doing work within a given transaction in the event that a server node halts, recovers, and rejoins the topology.</p><p>For any multi-server replication topology (including one using Group Replication), the XA transaction state propagates consistently, so that all servers remain in the same state at all times. For any such topology of any size (including a single server, as long as binary logging is enabled), it is now possible to recover any server to a consistent state after it has halted unexpectedly and been made to rejoin the topology after dropping out.</p><p>This enhancement is implemented for the case of a single server by adding support for a two-phase XA prepare between the storage engine and the server&rsquo;s internal transaction coordinator (ITC), with the state of the prepare retained by both. This means that the ITC can purge its internal logs safely, without the risk of losing state, should the server halt following the purge. In the single-node case, imposing order of execution between the storage engine and the binary log prevents externalization of GTIDs before the corresponding changes become visible to the storage engine; in a topology comprising multiple servers, this keeps the transaction state from being broadcast to the topology before it is guaranteed to be locally consistent and persistent. In all cases, the state of the XA transaction is extracted from the last binary log file to be written and synchronized with the transaction state obtained from the storage engine.</p><p>A known issue in this release can be encountered when the same transaction XID has been used to execute XA transactions sequentially. If there a disruption in operation occurs while the server is processing <code>XA COMMIT ... ONE PHASE</code> using this same XID, after the transaction has been prepared in the storage engine, the state between the binary log and the storage engine can no longer be reliably synchronized. See</p><p>For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/xa.html>XA Transactions</a>.</p></li></ul><h3 id=functionality-added-or-changed>Functionality Added or Changed</h3><ul><li><p><strong>Important Change:</strong> Binary packages that include curl rather than linking to the system curl library have been upgraded to use curl 7.83.1. (Bug #34138733)</p></li><li><p><strong>Important Change:</strong> For platforms on which OpenSSL libraries are bundled, the linked OpenSSL library for MySQL Server has been updated to version 1.1.1o. Issues fixed in OpenSSL version 1.1.1o are described at <a href=https://www.openssl.org/news/cl111.txt>https://www.openssl.org/news/cl111.txt</a> and <a href=https://www.openssl.org/news/vulnerabilities.html>https://www.openssl.org/news/vulnerabilities.html</a>. (Bug #34133985)</p></li><li><p><strong>Important Change:</strong> The <code>fido2</code> library included with MySQL, used with the <code>authentication_fido</code> plugin, has been upgraded to version 1.8.0. (Previously, version 1.5.0 was included with MySQL.)</p><p>For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/fido-pluggable-authentication.html>FIDO Pluggable Authentication</a>.</p></li><li><p><strong>InnoDB:</strong> The <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_doublewrite><code>innodb_doublewrite</code></a> system variable, which enables or disables the doublewrite buffer, has two new settings, <code>DETECT_ONLY</code> and <code>DETECT_AND_RECOVER</code>. With the <code>DETECT_ONLY</code> setting, database page content is not written to the doublewrite buffer, and recovery does not use the doublewrite buffer to fix incomplete page writes. This lightweight setting is intended for detecting incomplete page writes only. The <code>DETECT_AND_RECOVER</code> setting is equivalent to the existing <code>ON</code> setting. For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-doublewrite-buffer.html>Doublewrite Buffer</a>.</p><p>Thanks to Facebook for the contribution. (Bug #32727919, Bug #103211)</p></li><li><p><strong>InnoDB:</strong> <code>InnoDB</code> now supports dynamic configuration of redo log capacity. The <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_redo_log_capacity><code>innodb_redo_log_capacity</code></a> system variable can be set at runtime to increase or decrease the total amount of disk space occupied by redo log files.</p><p>With this change, the number of redo log files and their default location has also changed. From MySQL 8.0.30, <code>InnoDB</code> maintains 32 redo log files in the <code>#innodb_redo</code> directory in the data directory. Previously, <code>InnoDB</code> created two redo log files in the data directory by default, and the number and size of redo log files were controlled by the <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_log_files_in_group><code>innodb_log_files_in_group</code></a> and <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_log_file_size><code>innodb_log_file_size</code></a> variables. These two variables are now deprecated.</p><p>When the <code>innodb_redo_log_capacity</code> setting is defined, <code>innodb_log_files_in_group</code> and <code>innodb_log_file_size</code> settings are ignored; otherwise, those settings are used to compute the <code>innodb_redo_log_capacity</code> setting (<code>innodb_log_files_in_group</code> * <code>innodb_log_file_size</code> = <code>innodb_redo_log_capacity</code>). If none of those variables are set, redo log capacity is set to the <code>innodb_redo_log_capacity</code> default value, which is 104857600 bytes (100MB).</p><p>Several status variables are provided for monitoring the redo log and redo log capacity resize operations.</p><p>As is generally required for any upgrade, this change requires a clean shutdown before upgrading.</p><p>For more information about this feature, see <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-redo-log.html>Redo Log</a>.</p></li><li><p>Added Ubuntu 22.04 support. (Bug #34123545)</p></li><li><p>The order of the columns in the primary key definition for a few tables in the <code>mysql</code> schema has been changed, so that the columns containing the host name and user name are together in sequence at the start of the primary key. ACL queries on these tables are performed using only the host name and user name, and if those columns are not together in sequence, a full table scan must be performed to identify the relevant record. Placing the host name and user name together means that index lookup can be used, which improves performance for <code>CREATE USER</code>, <code>DROP USER</code>, and <code>RENAME USER</code> statements, and for ACL checks for multiple users with multiple privileges.</p><p>The changed tables are <code>mysql.db</code>, <code>mysql.tables_priv</code>, <code>mysql.columns_priv</code> and <code>mysql.procs_priv</code>. When you upgrade to MySQL 8.0.30 or later, these tables are modified in the second step of the MySQL upgrade process. Use the <code>--upgrade=FORCE</code> option when performing logical upgrades using a backup or export utility such as <strong>mysqldump</strong> or <strong>mysqlpump</strong>, which ensures that the table structures are checked and rebuilt with the new column order. (Bug #33644645, Bug #33637244)</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_myisam_repair_threads><code>myisam_repair_threads</code></a> system variable and <strong>myisamchk</strong> <a href=https://dev.mysql.com/doc/refman/8.0/en/myisamchk-repair-options.html#option_myisamchk_parallel-recover><code>--parallel-recover</code></a> option were removed. (Bug #31052408)</p></li><li><p>A new <strong>mysqldump</strong> option <code>--mysqld-long-query-time</code> lets you set a custom value of the <code>long_query_time</code> system variable for <strong>mysqldump</strong>’s session. Use the new option to increase the elapsed time allowed for <strong>mysqldump</strong>’s queries before they are written to the slow query log file, in order to avoid unnecessary logging. Thanks to Facebook for the contribution. (Bug #96369, Bug #96369, Bug #30110717)</p></li><li><p>Error log components can now be loaded implicitly at startup before the <code>InnoDB</code> storage engine is available. This new method of loading error log components loads and enables the components defined by the <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_log_error_services><code>log_error_services</code></a> variable.</p><p>Previously, error log components had to be installed first using <a href=https://dev.mysql.com/doc/refman/8.0/en/install-component.html><code>INSTALL COMPONENT</code></a> and were only loaded after <code>InnoDB</code> was fully available, as the list of components to load was read from the <code>mysql.components</code> table, which is an <code>InnoDB</code> table.</p><p>Implicit load of error log components has these advantages:</p><ul><li><p>Log components are loaded early in the startup sequence, making logged information available sooner.</p></li><li><p>It helps avoid loss of buffered log information should a failure occur during startup.</p></li><li><p>Loading log components using <a href=https://dev.mysql.com/doc/refman/8.0/en/install-component.html><code>INSTALL COMPONENT</code></a> is not required, simplifying error log configuration.</p></li></ul><p>For more information about this feature, see <a href=https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html>Error Log Configuration</a>.</p><p>If you have previously installed loadable log components using <code>INSTALL COMPONENT</code> and you list those components in a <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_log_error_services><code>log_error_services</code></a> setting that is read at startup (from an option file, for example), your configuration should be updated to avoid startup warnings. For more information, see <a href=https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html#error-log-configuration-methods>Error Log Configuration Methods</a>.</p></li><li><p>MySQL Enterprise Audit’s audit log file can now be extended with optional data fields to show the query time, the number of bytes sent and received, the number of rows returned to the client, and the number of rows examined. This data is available in the slow query log for qualifying queries, and in the context of the audit log it similarly helps to detect outliers for activity analysis. It is delivered to the audit log through new component services that you set up as an audit log filtering function. The extended data fields can only be added when the audit log is in JSON format (<code>audit_log_format=JSON</code>), which is not the default setting.</p></li><li><p>MySQL Server’s <code>AES_ENCRYPT()</code> and <code>AES_DECRYPT()</code> functions now support the use of a key derivation function (KDF) to create a cryptographically strong secret key from information such as a password or a passphrase that you pass to the function. The derived key is used to encrypt and decrypt the data, and it remains in the MySQL Server instance and is not accessible to users. Using a KDF is highly recommended, as it provides better security than specifying your own premade key or deriving it by a simpler method when you use the function. The functions support HKDF (available from OpenSSL 1.1.0), for which you can specify an optional salt and context-specific information to include in the keying material, and PBKDF2 (available from OpenSSL 1.0.2), for which you can specify an optional salt and set the number of iterations used to produce the key.</p></li><li><p>A new system status variable <code>Tls_library_version</code> shows the runtime version of the OpenSSL library that is in use for the MySQL instance. The version of OpenSSL affects features such as support for TLSv1.3.</p></li><li><p>From MySQL 8.0.30, MySQL Enterprise Encryption’s functions are provided by a component, rather than being installed from the <code>openssl_udf</code> shared library. The new functions provided by the component use only the generally preferred RSA algorithm, not the DSA algorithm or the Diffie-Hellman key exchange method, and they follow current best practice on minimum key size. The component functions also add support for SHA3 for digests (provided that OpenSSL 1.1.1 is in use), and do not require digests for signatures, although they support them.</p><p>If you upgrade to MySQL 8.0.30 from an earlier release where the functions are installed manually from the <code>openssl_udf</code> shared library file, the functions you created remain available and are supported. However, these legacy functions are deprecated from this release, and it is recommended that you install the component instead. The component functions are backward compatible, so RSA public and private keys, encrypted data, and signatures that were produced by the legacy functions can be used with the component functions. For the component functions to support decryption and verification for content produced by the legacy functions, you must set the new system variable <code>enterprise_encryption.rsa_support_legacy_padding</code> to <code>ON</code> (the default is <code>OFF</code>).</p><p>The component functions generate public and private RSA keys in PKCS #8 format. They allow a minimum key size of 2048 bits, which is a suitable minimum RSA key length for current best practice. You can set a maximum key size up to 16384 bits using the system variable <code>enterprise_encryption.maximum_rsa_key_size</code>, which defaults to a maximum key size of 4096 bits.</p></li><li><p>Connections whose users have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin><code>CONNECTION_ADMIN</code></a> privilege are not terminated when MySQL Server is set to offline mode, which is done by changing the value of the <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_offline_mode><code>offline_mode</code></a> system variable to <code>ON</code>. Previously, checking for connections that had the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin><code>CONNECTION_ADMIN</code></a> privilege could cause a race condition because it involved accessing other threads. Now, a flag for each thread caches whether or not the user for the thread has the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin><code>CONNECTION_ADMIN</code></a> privilege. The flag is updated if the user privilege changes. When offline mode is activated for the server, this flag is checked for each thread, rather than the security context of another thread. This change makes the operation threadsafe.</p><p>In addition, when offline mode is activated, connections whose users have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> privilege are now only terminated if the user that runs the operation also has the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> privilege. Users that only have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-variables-admin><code>SYSTEM_VARIABLES_ADMIN</code></a> privilege, and do not have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> privilege, can set the <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_offline_mode><code>offline_mode</code></a> system variable to <code>ON</code> to activate offline mode. However, when they run the operation, any sessions whose users have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> privilege remain connected, in addition to any sessions whose users have the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin><code>CONNECTION_ADMIN</code></a> privilege. This only applies to existing connections at the time of the operation; users with the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> privilege but without the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin><code>CONNECTION_ADMIN</code></a> privilege cannot make new connections to a system in offline mode.</p></li><li><p><a href=https://dev.mysql.com/doc/refman/8.0/en/performance-schema.html>Performance Schema</a> provides instrumentation for performance monitoring of Group Replication memory usage.</p><p>See <a href=https://dev.mysql.com/doc/refman/8.0/en/mysql-gr-memory-monitoring-ps-instruments.html>Monitoring Group Replication Memory Usage with Performance Schema Memory Instrumentation</a>.</p></li></ul><h3 id=bugs-fixed>Bugs Fixed</h3><ul><li><p><strong>InnoDB:</strong> A <a href=https://dev.mysql.com/doc/refman/8.0/en/truncate-table.html><code>TRUNCATE TABLE</code></a> operation failed to remove data dictionary entries for columns that were dropped using <code>ALGORITHM=INSTANT</code>.</p><p>Thanks to Marcelo Altmann for the contribution. (Bug #34302445)</p></li><li><p><strong>InnoDB:</strong> An incorrect nullable column calculation on tables with instantly added columns caused data to be interpreted incorrectly. (Bug #34243694)</p></li><li><p><strong>InnoDB:</strong> After upgrading to MySQL 8.0.29, a failure occurred when attempting to access a table with an instantly added column. (Bug #34233264)</p></li><li><p><strong>InnoDB:</strong> Only the physical position of instantly added columns was logged, which was not sufficient for index recovery. The logical position of columns was also required. (Bug #34181432)</p></li><li><p><strong>InnoDB:</strong> The <code>field_phy_pos</code> debug variable in the <code>InnoDB</code> sources was not updated for child tables during a cascading update operation. (Bug #34181419)</p></li><li><p><strong>InnoDB:</strong> Some instances of the <code>rec_get_instant_row_version_old()</code> function in the InnoDB sources did not check for row versioning. (Bug #34173616)</p></li><li><p><strong>InnoDB:</strong> The <code>read_2_bytes()</code> function in the InnoDB sources, which reads bytes from the log buffer, returned a null pointer. (Bug #34173425)</p></li><li><p><strong>InnoDB:</strong> In the Performance Schema instrumentation for InnoDB read-write locks, lock acquisition failures and successes for TRY (no-wait) operations were instrumented incorrectly. (Bug #34131395)</p></li><li><p><strong>InnoDB:</strong> In a specific locking scenario, an implicit lock was not converted to an explicit lock as expected, triggering a <code>lock_rec_has_expl(LOCK_X | LOCK_REC_NOT_GAP, block, heap_no, trx</code>) debug assertion failure. (Bug #34123159)</p></li><li><p><strong>InnoDB:</strong> A check that determines if a table has instantly added columns was performed for each column, which affected the performance of <code>ADD</code> and <code>DROP COLUMN</code> operations on tables with numerous columns. The check is now performed once per table. (Bug #34112147)</p></li><li><p><strong>InnoDB:</strong> A workload that generated a large number of lock requests and numerous timeouts caused a long semaphore wait failure. To address this issue, optimizations were implemented to reduce the number of exclusive global lock system latches. (Bug #34097862)</p></li><li><p><strong>InnoDB:</strong> The <code>m_flush_bit</code> in the redo log block header, which was set for the first block of multiple blocks written in a single log write call, provided no benefit and has been removed. (Bug #34091444)</p></li><li><p><strong>InnoDB:</strong> Fixed clang-tidy and cppcheck warnings, which included the removal of unused code and unnecessary checks. (Bug #33957087)</p></li><li><p><strong>InnoDB:</strong> Recovery of a redo log file mini-transaction (<code>mtr</code>) caused a debug assertion failure on a MySQL Server instance with a small <a href=https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_log_buffer_size><code>innodb_log_buffer_size</code></a> setting.</p><p>Thanks to Mengchu Shi for the contribution. (Bug #33945602)</p></li><li><p><strong>InnoDB:</strong> Compiling with the <a href=https://dev.mysql.com/doc/refman/8.0/en/source-configuration-options.html#option_cmake_with_valgrind><code>WITH_VALGRIND</code></a> source configuration option produced <code>Wunused-variable</code> warnings. (Bug #33899862)</p></li><li><p><strong>InnoDB:</strong> Multiple issues with the lock-free hash table (<code>ut_lock_free_hash_t</code>) were addressed. (Bug #33830934)</p></li><li><p><strong>InnoDB:</strong> A query on a generated column with a secondary index caused a failure. The field number representing the position of the generated column was not valid. (Bug #33825077)</p></li><li><p><strong>InnoDB:</strong> Memory consumption was greater than expected when updating and inserting rows with multi-valued index columns. The memory allocated for multi-valued columns for each row update was held until the file handle was released. (Bug #33766482)</p></li><li><p><strong>InnoDB:</strong> The <code>UT_LOCATION_HERE</code> structure in the <code>InnoDB</code> sources was not used consistently. (Bug #33436161)</p></li><li><p><strong>InnoDB:</strong> A table object needed to retrieve an array of values from a multi-valued index column when computing the value of a generated column was unavailable. (Bug #32725063)</p></li><li><p><strong>InnoDB:</strong> A 4GB tablespace file size limit on Widows 32-bit systems has been removed. The limit was due to an incorrect calculation performed while extending the tablespace. (Bug #28934351)</p></li><li><p><strong>InnoDB:</strong> Hash and random generator functions in the <code>InnoDB</code> sources were improved. (Bug #16739204, Bug #23584861)</p></li><li><p><strong>InnoDB:</strong> A <a href=https://dev.mysql.com/doc/refman/8.0/en/drop-table.html><code>DROP TABLE</code></a> operation on a table with a discarded tablespace caused an unnecessary assertion failure. (Bug #107207, Bug #34135187)</p></li><li><p><strong>InnoDB:</strong> A query on a table with a <code>JSON</code> column returned only a partial result set after adding a multi-valued index. (Bug #106621, Bug #33917625)</p></li><li><p><strong>InnoDB:</strong> Purging a record with multiple binary large object values raised an insertion failure due to a mini-transaction (mtr) conflict. (Bug #105592, Bug #33574272)</p></li><li><p><strong>InnoDB:</strong> Enabling the adaptive hash index (AHI) on a high-concurrency instance caused temporary AHI search latch contention while the hash index was being built.</p><p>Thanks to Zhou Xinjing from CDB Team at Tencent for the patch. (Bug #100512, Bug #31750840)</p></li><li><p><strong>Packaging:</strong> The SASL LDAP clientside plugin was missing from the MySQL Community packages for Windows.</p></li><li><p><strong>Replication:</strong> When a table definition diverged between the source and the replica because the replica had an extra primary key, updates and deletes on the replica would fail if that table had an index that was present both on the source and the replica. Primary keys for an InnoDB table are automatically included in all indexes, and the replication applier needs values for all parts of the key to be included in an event in order to search the index. Previously, the applier checked that all the user-defined key parts were present, but the check did not cover hidden primary keys that were automatically included. The applier now validates that both user-defined and automatically included key parts are present in an event before using the index to search the data. (Bug #34122738)</p></li><li><p><strong>Replication:</strong> The write sets extracted by MySQL Replication from transactions when the <code>transaction_write_set_extraction</code> system variable is enabled (which is the default) are extracted from primary keys, unique keys, and foreign keys. They are used to detect dependencies and conflicts between transactions. Previously, write sets involving multi-column foreign keys were incorrectly identifying each column as a separate foreign key. The issue has now been fixed and foreign key write sets include all referenced key columns. (Bug #34095747, Bug #34144531)</p></li><li><p><strong>Replication:</strong> When row-based replication was in use, a replica could sometimes override the SQL mode value that was sent by the source, in an attempt to avoid issues with additional columns on the slave. In extreme cases this could lead to data divergence. The problem has been corrected so the replica now preserves the source’s SQL mode wherever possible. (Bug #33945038)</p></li><li><p><strong>Replication:</strong> The <code>COUNT_TRANSACTIONS_REMOTE_IN_APPLIER_QUEUE</code> column in the Performance Schema table <code>replication_group_member_stats</code> could persistently show transactions related to view change events (<code>View_change_log_event</code>) that had already been applied. These events are queued in the Group Replication applier channel but applied in the Group Replication recovery channel, causing a race condition that could result in the counter decrement being lost. The increment of the count now takes place at a more suitable point, and the counter for <code>COUNT_TRANSACTIONS_REMOTE_IN_APPLIER_QUEUE</code> is also now set to zero when the applier is not busy. (Bug #33602354, Bug #33674059)</p></li><li><p><strong>Replication:</strong> The message that is recorded when a member tries to rejoin a Group Replication topology when there is an old incarnation of the same server still present, has been upgraded from an informational note to a warning message. (Bug #32651024)</p></li><li><p><strong>Replication:</strong> MySQL’s semisynchronous replication did not respect the value of the <code>net_read_timeout</code> system variable and forced a read timeout of one millisecond. This could result in the function experiencing partial reads of acknowledgment messages and packets arriving out of order, while other connections in the MySQL system were functioning correctly. The value of the <code>net_read_timeout</code> system variable is now applied to connections for semisynchronous replication. (Bug #101056, Bug #31976209)</p></li><li><p><strong>Replication:</strong> When the <code>--replicate-same-server-id</code> option was used to make the replica not skip events that have its own server ID, if the log file was rotated, replication stopped with an error. The log rotation event now checks and applies the current value of the option. (Bug #89375, Bug #27492990)</p></li><li><p><strong>API:</strong> Applications that previously used the MySQL client library to perform an automatic reconnection to the server received the following mysql_query error after the server was upgraded:</p><p>[4031] The client was disconnected by the server because of inactivity. See wait_timeout and interactive_timeout for configuring this behavior. (Bug #105229, Bug #34007830)</p></li><li><p>Pushing a condition down to a derived table was not handled correctly in all cases. (Bug #34311090)</p></li><li><p>After pushing down a condition to a derived table having a set operation, while folding an always true boolean condition, the rewrite was not correct due to not setting <code>abort_on_null</code> to true for the cloned condition when making a copy during condition pushdown to a derived table with a set operation. (Bug #34298238)</p></li><li><p>A missing error return when processing an invalid <code>ORDER BY</code> expression in a view definition led to an assert in debug builds. (Bug #34239456)</p></li><li><p>MySQL Server would not compile with the latest version of Visual Studio 2022. (Bug #34231639)</p></li><li><p>While attempting to clone a system variable during condition pushdown, the server sometimes could not determine the correct context of the cloned expression.</p><p>To prevent this, we disallow condition pushdown to derived tables when they use system variables, or if the underlying expressions in the derived table contain system variables. (Bug #34205559)</p></li><li><p>Added Enterprise Linux 9 (EL9) support. (Bug #34190004)</p></li><li><p>On macOS 11, MySQL Server did not have the correct entitlement to generate a core dump in the event of an unexpected server halt. A build option WITH_DEVELOPER_ENTITLEMENTS has been added to allow a build to generate core dumps. (Bug #34163987)</p></li><li><p>Improved error handling for &lsquo;-DWITH_LIBEVENT=system&rsquo; and &lsquo;-DWITH_EDITLINE=system&rsquo; on systems missing libevent-devel or libedit-devel. (Bug #34131334, Bug #34123545)</p></li><li><p>The fix for Bug #33830493 in MySQL 8.0.29 addressed the situation where if a MySQL instance stopped unexpectedly or was restarted shortly after a <code>SET PERSIST</code> statement was used to record system variable settings, the configuration file <code>mysqld-auto.cnf</code> could be left empty, in which case the server restart could not proceed. The persisted system variables are now written to a backup file, which is only renamed to <code>mysqld-auto.cnf</code> after the success of the write has been verified, leaving the original <code>mysqld-auto.cnf</code> file still available. On a restart, if a backup file with valid contents is found, the server reads from that file. Otherwise the <code>mysqld-auto.cnf</code> file is used and the backup file is deleted. The file was not flushed to disk by this fix, so it was still possible for the issue to occur. This patch adds those operations. (Bug #34122866)</p></li><li><p>Fixed the -DENABLE_GCOV CMake option. (Bug #34113243)</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_sensitive-variables-observer><code>SENSITIVE_VARIABLES_OBSERVER</code></a> privilege, introduced in MySQL 8.0.29, is now granted to users with the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-variables-admin><code>SYSTEM_VARIABLES_ADMIN</code></a> privilege during upgrade. Previously, the privilege was not granted to any database user during upgrade. (Bug #34068378)</p></li><li><p>A select from a view that used left joins did not return any results. (Bug #34060289)</p></li><li><p>Under certain circumstances <code>TRUNCATE performance_schema.accounts</code> caused duplicated counts in <a href=https://dev.mysql.com/doc/refman/8.0/en/performance-schema-status-variable-tables.html><code>global_status</code></a>.</p><p>This occurred if some hosts were not instrumented. For example, if <a href=https://dev.mysql.com/doc/refman/8.0/en/performance-schema-system-variables.html#sysvar_performance_schema_hosts_size><code>performance_schema_hosts_size</code></a> was set to a low value.</p><p>Our thanks to Yuxiang Jiang and the Tencent team for the contribution. (Bug #34057013, Bug #106939)</p></li><li><p>It was possible under certain conditions for <a href=https://dev.mysql.com/doc/refman/8.0/en/explain.html#explain-analyze><code>EXPLAIN ANALYZE</code></a> to attempt access of an iterator that did not exist. (Bug #34051681)</p><p>References: This issue is a regression of: Bug #33905399.</p></li><li><p>Support was added for compiling the <code>keyring_oci</code> plugin with OpenSSL 3. (Bug #34043013)</p></li><li><p>Events recorded in the Performance Schema tables for thread creation and deletion were retained until server shutdown, instead of being removed when the client connection ended. Thread creation and deletion now takes place after the Performance Schema instrumentation is created for the user session, so it is cleaned up when the session ends. (Bug #34019988)</p></li><li><p>Upgraded the bundled zlib library to zlib 1.2.12. Also made zlib 1.2.12 the minimum zlib version supported, and removed WITH_ZLIB from the WITH_SYSTEM_LIBS CMake option. (Bug #34015600)</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_connection-id><code>CONNECTION_ID()</code></a> function, since it returns a session ID which remains constant for the lifetime of the session, was treated as a constant function. This caused issues when <code>CONNECTION_ID()</code> was used inside a trigger attached to a table which might be reused by other sessions. We fix this by making the function <code>const</code> for execution, and returning the actual session ID when the function is evaluated. (Bug #34009876)</p></li><li><p>Executed <code>codespell</code> on the majority of source code, and fixed the reported spelling errors in the code comments. (Bug #34006439)</p></li><li><p>The MySQL Enterprise Encryption <code>openssl_udf</code> function library plugin was reimplemented to use OpenSSL 3 APIs. (Bug #33992115)</p></li><li><p><code>FEDERATED</code> storage engine code was revised to address NULL pointer and variable access issues. (Bug #33962357)</p></li><li><p>Histograms in MySQL returned a selectivity estimate of <code>0</code> for values that outside buckets. This meant that values might be missing from the histogram because they were missed during sampling, or because the histogram had grown stale. To prevent this, we introduce a constant lower bound of <code>0.001</code> on the selectivity estimates produced by histograms. This choice of lower bound corresponds to the selectivity of a value or range that we are likely to miss during sampling.</p><p>Using a constant lower bound rather than a statistical estimate for the selectivity of a missing value has the advantage of simplicity and predictability, and provides some protection against underestimating the selectivity due to stale histograms and within-bucket heuristics.</p><p>For more information about histograms in MySQL, see <a href=https://dev.mysql.com/doc/refman/8.0/en/optimizer-statistics.html>Optimizer Statistics</a>. (Bug #33935417)</p></li><li><p>For certain queries using a common table expression (CTE), <a href=https://dev.mysql.com/doc/refman/8.0/en/explain.html#explain-analyze><code>EXPLAIN ANALYZE</code></a> did not provide any profiling data for the CTE even when the CTE was known to be executed. This happened when the following conditions were met:</p><ul><li><p>The CTE was referenced more than once in the query plan.</p></li><li><p>The first reference to the CTE (in the order of the output of <code>EXPLAIN FORMAT=TREE</code>) was never executed.</p></li><li><p>At least one of the subsequent references was executed at least once.</p></li></ul><p>The problem was that the CTE plan was always printed when encountering the first reference to the CTE; if that reference was never executed, the CTE was not materialized there; and thus there was no profiling data to print.</p><p>The fix for this issue ensures that we print the CTE plan when it is first executed, that is, the point at which it is materialized. The output then includes profiling data. If the CTE is never executed, we print the plan at the last reference, when there is no profiling data. (Bug #33905399)</p></li><li><p>The output from the command <code>mysqld --verbose --help</code> previously showed plugin load options as <code>ON</code> even when they were off by default, or turned off using an option. The output now shows the current value for the plugin. (Bug #33870892)</p></li><li><p>The Server now bundles curl (7.83.1) and only uses it when alternative SSL systems are used, such as openssl11 on EL7. (Bug #33859507, Bug #34154806)</p></li><li><p>Debug MySQL binaries can now be built using <code>-0g</code> and <code>-fno-inline</code>. (Bug #33855533)</p></li><li><p>The <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_firewall-exempt><code>FIREWALL_EXEMPT</code></a> privilege, introduced in MySQL 8.0.27, is now granted to users with the <a href=https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user><code>SYSTEM_USER</code></a> during upgrade. Previously, the privilege was not granted to any database user during upgrade. (Bug #33854409)</p></li><li><p>A correlated subquery did not use a functional index as expected. This occurred when an outer column reference used inside the subquery was not considered as constant for subquery execution, which allowed consideration of the functional index to be skipped.</p><p>We fix this problem by making sure to consider the outer column reference as constant while executing the subquery. (Bug #33851055)</p></li><li><p>Added alternate OpenSSL system package support by passing in openssl11 on EL7 or openssl3 on EL8 to the WITH_SSL Cmake option. Authentication plugins, such as LDAP and Kerberos, are disabled as they do not support these alternative versions of OpenSSL. (Bug #33835934)</p></li><li><p>Prepared statements with subqueries that accessed no tables, but the subquery evaluation raised an error, triggered an assert failure in debug builds. (Bug #33773799)</p></li><li><p>Some stored functions were not executed correctly following the first invocation. (Bug #33754993)</p></li><li><p>When performing a query using a recursive common table expression (CTE) with a removal of a query expression after constant predicate elimination, it is expected that when the reference count of table objects for the CTE temporary table reaches zero, it should be possible once again to recreate the table, but in certain cases one of the table references was not properly recorded as attached to the CTE. (Bug #33725503)</p><p>References: See also: Bug #32962511.</p></li><li><p>Added a missing error return to the parser. (Bug #33725502)</p></li><li><p>A number of issues with pushdown of conditions making use of outer references, relating to work done in MySQL 8.0.22 to implement condition pushdown for materialized derived tables, have been identified and resolved. (Bug #33725403, Bug #33725500, Bug #33725508, Bug #33725534, Bug #33725545)</p></li><li><p>The plan generated for a <a href=https://dev.mysql.com/doc/refman/8.0/en/select.html><code>SELECT</code></a> using a common table expression involves table materialization and an index scan on the materialized table. Because the <code>temptable</code> engine does not yet support all index scan methods, such queries might not always execute correctly.</p><p>With other MySQL engines, the materialization access path has special handling when the access path is not considered basic; for <code>temptable</code>, an index scan was not considered basic, which led to undefined behavior.</p><p>We fix this issue by considering the index scan access path basic, and thus avoiding use of any index scan access methods on <code>temptable</code> tables. (Bug #33700735)</p></li><li><p>The <code>Data_free</code> column in the <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-files-table.html><code>INFORMATION_SCHEMA.FILES</code></a> table was not updated after adding a new data file to the <code>InnoDB</code> system tablespace. (Bug #33508534)</p></li><li><p>If a plugin attempted to register a system variable with a name that duplicated that of an existing system variable, the existing static system variable might be overwritten, and uninstalling the plugin might leave pointers to the freed memory. The issues have now been fixed. (Bug #33451101)</p></li><li><p><code>SHOW TABLES</code> and <code>SELECT * FROM INFORMATION_SCHEMA.TABLES</code> did not return any results from the Performance Schema if the user had access privileges on individual Performance Schema tables, only. (Bug #33283709)</p></li><li><p>Calling a function relating to the <code>data_masking</code> plugin without first installing the plugin led to an unplanned server shutdown. Functions relating to this plugin are initialized by calling init functions which in turn access the UDF metadata service, but this is valid only when the data masking plugin is installed. We fix this problem by adding a check to verify that the plugin is installed before initializing such functions, and to return an appropriate error message if the plugin providing them is not installed. (Bug #33234046)</p></li><li><p>Under certain conditions, the server did not handle the expiration of <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_max_execution_time><code>max_execution_time</code></a> or the execution of a <a href=https://dev.mysql.com/doc/refman/8.0/en/kill.html><code>KILL</code></a> statement correctly. (Bug #33218625)</p></li><li><p><strong>mysqlslap</strong>, which uses multiple threads to connect to the server, could not run with a user account that used FIDO authentication. The issue has been fixed by an update to the FIDO library allowing the authentication to be performed on multiple threads. (Bug #33067183)</p></li><li><p>A deadlock could occur in Group Replication when a member was interacting with the service infrastructure, such as a joining member checking for incompatible configuration and then leaving the group due to it. The issue has now been fixed. (Bug #32688091)</p></li><li><p>If an incorrect value was set for the <code>binlog_checksum</code> system variable during a session, a <strong>COM_BINLOG_DUMP</strong> command made in the same session to request a binary log stream from a source failed. The server now validates the specified checksum value before starting the checksum algorithm setup process. (Bug #32442749)</p></li><li><p>For slow query logging, the <a href=https://dev.mysql.com/doc/refman/8.0/en/server-status-variables.html#statvar_Slow_queries><code>Slow_queries</code></a> status variable was not implemented unless the slow query log was enabled, contrary to the documentation. (Bug #28268680, Bug #91496)</p></li><li><p>A prepared statement could accept an empty string as a valid float value, which represents a regression from 8.0.27 behavior. This fix explicitly checks that the length of an interpreted string is non-empty and fully interpreted as a (float) number. In addition, new verification now ensures that:</p><ul><li><p>All numeric values are supported with empty strings and strings that are all spaces.</p></li><li><p>Regular numeric values are supported, as well as numeric values with leading and trailing spaces.</p></li></ul><p>(Bug #107399, Bug #34213338)</p><p>References: This issue is a regression of: Bug #32213576.</p></li><li><p>Upgrading to MySQL 8.0.29 led to issues with existing spatial indexes (see <a href=https://dev.mysql.com/doc/refman/8.0/en/creating-spatial-indexes.html>Creating Spatial Indexes</a>). The root cause of the problem was a change in how geographic area computations were performed by the included Boost library, which was upgraded to version 1.77.0 in MySQL 8.0.29. We fix this by ensuring that we accommodate the new method whenever such computations are performed. (Bug #107320, Bug #34184111)</p><p>References: This issue is a regression of: Bug #33353637.</p></li><li><p>When pushing a condition down to derived table for prepared statements, we clone a condition which also includes parameters when a derived table contains unions. When a statement needed to be reprepared during execution—for example, when the signedness of the value specified did not match that of the actual datatype—the parameter was not cloned correctly resulting in errors. This occurred because the value specified for the parameter was used to print the string for reparsing, instead of a literal <code>?</code> placeholder character.</p><p>Now in such cases we set a flag <code>QT_NO_DATA_EXPANSION</code> for printing parameters for reparsing which, when enabled, causes the <code>?</code> placeholder to be printed, rather than the actual value. (Bug #107230, Bug #34148712)</p></li><li><p>On MacOS, improved Boost library detection logic for Homebrew as a potentially incompatible system&rsquo;s Boost version could get used even with <code>-DWITH_BOOST</code> set. (Bug #107151, Bug #34121866)</p><p>References: This issue is a regression of: Bug #33769505.</p></li><li><p>On RHEL 7.x, fetching the CPU cache line size returned 0 on s390x RHEL 7.x which caused rpl_commit_order_queue and integrals_lockfree_queue to fail.</p><p>Our thanks to Namrata Bhave for the contribution. (Bug #107081, Bug #34095278)</p></li><li><p>When the <strong>mysql</strong> client was unable to reconnect to the server following an unexpected server halt, the process of building the completion hash allocated memory that was not freed. The reconnection operation now does not build the completion hash if the client fails to reconnect, and the memory concerned is freed if the client is disconnected. (Bug #106864, Bug #34019571)</p></li><li><p>Added a cycle timer for the s390x architecture.</p><p>Our thanks to Namrata Bhave for the contribution. (Bug #106824, Bug #33997819)</p></li><li><p>In certain cases, incorrect results could result from execution of a semijoin with materialization, when the <code>WHERE</code> clause of the subquery contained an equality. In some cases, such as when one side of such an equality was an <code>IN</code> or <code>NOT IN</code> subquery, the equality was neither pushed down to the materialized subquery, nor evaluated as part of the semijoin. This also caused issues with some inner hash joins. (Bug #106710, Bug #106718, Bug #33952115, Bug #33957233)</p><p>References: See also: Bug #84705, Bug #25466100.</p></li><li><p>Comparator functions for queries like <code>(&lt;date column> &lt;non-date column>) IN ((val1, val2), (val3, val4), …)</code> could return the wrong results. (Bug #106567, Bug #33897969)</p></li><li><p>Fixed an assert definition in SetOsLimitMaxOpenFiles; our thanks to hongyuan li for the contribution. (Bug #106555, Bug #33893197)</p></li><li><p>Previously, it was assumed that, when the same non-nullable expression was used as both the first and second arguments to <a href=https://dev.mysql.com/doc/refman/8.0/en/string-comparison-functions.html#operator_like><code>LIKE</code></a>, the result was always true, and so could be optimized away. This assumption turns out not to be valid, due to the fact that <code>LIKE</code> treats the backslash (<code>\</code>) as an escape character, even when <code>ESCAPE</code> is not specified. This led to different results when the condition was used in the <code>SELECT</code> list as opposed to the <code>WHERE</code> clause. To fix the problem, we no longer perform this optimization with <code>LIKE</code>, with or without an <code>ESCAPE</code> clause. (Bug #106444, Bug #33852756)</p></li><li><p>In some cases, when arguments other than global transaction IDs (such as column values) were passed to <a href=https://dev.mysql.com/doc/refman/8.0/en/gtid-functions.html#function_gtid-subset><code>GTID_SUBSET()</code></a>, the function returned values other than the expected <code>NULL</code>. (Bug #106298, Bug #33793942)</p></li><li><p>A problem with evaluation of general quantified comparison predicates occurred when the left-hand side of the predicate was <code>NULL</code>. In such cases, the value of the subquery evaluation from the last current row is saved, so that it does not need re-evaluation, but the cached value (<code>result_for_null_param</code>) was not cleared between executions, so that the next execution could re-use the result from the previous execution. One consequence of this was that, when a subquery execution first caused zero rows to match from the subquery—which for an <code>ALL</code> predicate should return <code>TRUE</code>—a subsequent execution causing at least one row to match also returned <code>TRUE</code>, even though <code>FALSE</code> was expected.</p><p>To solve this issue, we now make sure to clear <code>result_for_null_param</code> while cleaning up the subquery predicate following execution. (Bug #106164, Bug #37755139)</p></li><li><p>Test cases executed with the <code>--async-client</code> option and shutdown commands caused <strong>mysqltest</strong> to halt unexpectedly. (Bug #105797, Bug #33643149)</p></li><li><p>MySQL supports the use of equiheight histograms to improve selectivity estimates. Each bucket in an equiheight histogram for a column should contain roughly the same number of values (rows); keeping the buckets small helps minimize any error.</p><p>When constructing an equiheight histogram, too many values were sometime placed in the same bucket, which could result in substantial errors in selectivity estimation. We fix this by introducing a new equiheight construction algorithm that guarantees low error, and adapts to the distribution of the data to make efficient use of its buckets. In addition, a new estimator for the number of distinct values in histogram buckets provides improved worst-case error guarantees.</p><p>See <a href=https://dev.mysql.com/doc/refman/8.0/en/information-schema-column-statistics-table.html>The INFORMATION_SCHEMA COLUMN_STATISTICS Table</a>, and <a href=https://dev.mysql.com/doc/refman/8.0/en/optimizer-statistics.html>Optimizer Statistics</a>, for more information. (Bug #104789, Bug #33302021)</p></li><li><p>Deprecation warnings returned to client programs were sent to <code>stdout</code> rather than <code>stderr</code>, which in the case of <strong>mysqldump</strong> could mean that the dump file no longer worked because the warnings were included in it. The issue has now been fixed and the warnings are sent to <code>stderr</code>. (Bug #104769, Bug #33733529)</p></li><li><p>Extended support for chained SSL certificates. (Bug #54158, Bug #27491518)</p></li></ul><h2 id=reference>Reference</h2><p><a href=https://dev.mysql.com/doc/relnotes/mysql/8.0/en/news-8-0-30.html>https://dev.mysql.com/doc/relnotes/mysql/8.0/en/news-8-0-30.html</a></p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a class="btn btn-primary disabled"><span class=mr-1>←</span>Previous</a></li><a class="btn btn-primary disabled">Next<span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 tomhjx All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.9f90c5deff5c6f69d5eaaf614a76a233d8b0b3ae70b942fc78919b6d08041034.js integrity="sha256-n5DF3v9cb2nV6q9hSnaiM9iws65wuUL8eJGbbQgEEDQ=" crossorigin=anonymous></script></body></html>